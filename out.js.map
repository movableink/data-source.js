{"version":3,"file":"out.js","sources":["node_modules/cropduster/src/cropduster.js","src/index.ts"],"sourcesContent":["const DEPRECATION_MSG = 'callbacks are deprecated in cropduster, prefer using promises for asynchronous operations';\n\nconst CD = {\n  CORS_PROXY_SERVER: 'http://cors.movableink.com',\n\n  $(selector, doc) {\n    if (!doc) {\n      doc = document;\n    }\n\n    return [...doc.querySelectorAll(selector)];\n  },\n\n  _initParams() {\n    CD._urlParams = {};\n    const search = /([^&=]+)=?([^&]*)/g;\n    const query = CD._searchString();\n\n    let match = search.exec(query);\n    while (match) {\n      CD._urlParams[decodeURIComponent(match[1])] = decodeURIComponent(match[2]);\n      match = search.exec(query);\n    }\n  },\n\n  param(name) {\n    return CD.params()[name];\n  },\n\n  params(name) {\n    let params = CD._urlParams;\n    if (typeof params === 'undefined') {\n      CD._initParams();\n      params = CD._urlParams;\n    }\n\n    if (name) {\n      return params[name];\n    } else {\n      return params;\n    }\n  },\n\n  _searchString() {\n    return window.location.search.substring(1);\n  },\n\n  autofill() {\n    CD.param('init'); // inits CD._urlParams\n    const params = CD._urlParams;\n    for (const key in params) {\n      if (params[key] !== 'undefined' && params[key].length > 0) {\n        if (document.getElementById(`autofill_${key}`)) {\n          document.getElementById(`autofill_${key}`).innerHTML = params[key];\n        }\n      }\n    }\n  },\n\n  throwError(msg) {\n    CD.miCaptureFallback(\n      () => { MICapture.error(msg); },\n      () => { CD.log('Capturama error: ' + msg) }\n    );\n  },\n\n  cancelRequest(msg) {\n    CD.miCaptureFallback(\n      () => { MICapture.cancel(msg); },\n      () => { CD.log(`Request canceled: ${msg}`); }\n    );\n  },\n\n  setImageRedirect(imageUrl) {\n    const a = document.getElementById('mi-redirect-image') || document.createElement('a');\n\n    a.href = imageUrl;\n    a.id = 'mi-redirect-image';\n    a.style.display = 'none';\n\n    document.body.appendChild(a);\n\n    return a;\n  },\n\n  setClickthrough(url) {\n    const a = document.getElementById('mi_dynamic_link') || document.createElement('a');\n\n    a.href = url;\n    a.id = 'mi_dynamic_link';\n    a.style.display = 'none';\n\n    document.body.appendChild(a);\n\n    return a;\n  },\n\n  setExtraData(dataObject) {\n    const el = document.getElementById('mi-data') || document.createElement('div');\n\n    el.id = 'mi-data';\n    el.style.display = 'none';\n\n    let existingData;\n    try {\n      existingData = JSON.parse(el.getAttribute('data-mi-data')) || {};\n    } catch (_) {\n      // Overwrite if there was something in mi-data that wasn't JSON\n      existingData = {};\n    }\n\n    for (const key in dataObject) {\n      if (dataObject.hasOwnProperty(key)) {\n        existingData[key] = dataObject[key];\n      }\n    }\n\n    el.setAttribute('data-mi-data', JSON.stringify(existingData));\n    document.body.appendChild(el);\n\n    return el;\n  },\n\n  proxyUrl(url) {\n    const a = document.createElement('a');\n    a.href = url;\n\n    let port = '';\n    if (a.port === '0' || a.port === '') {\n      port = a.protocol === 'https:' ? ':443' : '';\n    } else {\n      port = `:${a.port}`;\n    }\n\n    const { hostname, pathname, search, hash } = a;\n    return `${CD.CORS_PROXY_SERVER}/${hostname}${port}${pathname}${search}${hash}`;\n  },\n\n  // internal, do not modify\n  _readyToCapture: true,\n\n  _reset() {\n    CD._readyToCapture = true;\n  },\n\n  pause(maxSuspension, msg = 'manual suspension') {\n    if (maxSuspension) {\n      msg += `, will end in ${maxSuspension}ms`;\n\n      setTimeout(() => {\n        CD.resume(msg);\n      }, maxSuspension);\n    }\n\n    CD.miCaptureFallback(\n      () => { MICapture.pause(msg) },\n      () => { CD.log(`paused: ${msg}`) }\n    );\n  },\n\n  resume(msg) {\n    CD.miCaptureFallback(\n      () => { MICapture.resume(msg) },\n      () => { CD.log(`resuming paused capture: ${msg}`)}\n    );\n  },\n\n  getCORS(url, options = {}, callback) {\n    if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n\n    options.corsCacheTime = options.corsCacheTime || 10 * 1000;\n    if (!/cors.movableink.com/.test(url)) {\n      url = CD.proxyUrl(url);\n    }\n\n    options.headers = options.headers || {};\n    options.headers['x-reverse-proxy-ttl'] = options.corsCacheTime / 1000;\n    options.headers['x-mi-cbe'] = this._hashForRequest(url, options);\n\n    return CD.get(url, options, callback);\n  },\n\n  get(url, options = {}, callback) {\n    if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n\n    const msg = `xhr: ${url}`;\n    const deprecatedCallback = function() {\n      if (callback && typeof callback === 'function') {\n        CD.log(DEPRECATION_MSG);\n        return callback(...arguments);\n      }\n    };\n\n    CD.pause(options.maxSuspension || 0, msg);\n\n    const requestOptions = CD._optionsForFetch(options);\n\n    return fetch(url, requestOptions).then(response => {\n      if (!response.ok) {\n        throw new Error(response.statusText); // A non-200 range status was returned\n      }\n\n      return response.text().then(data => {\n        const status = response.status;\n        const contentType = response.headers.get('Content-Type');\n\n        deprecatedCallback(data, status, contentType);\n\n        return {\n          data,\n          status,\n          contentType\n        };\n      });\n    }).then(\n      (response) => {\n        CD.resume(msg);\n        return response;\n      },\n      (error) => {\n        CD.log(`Error encountered in CD.get for ${url}: ${error}`);\n        CD.resume(msg);\n\n        deprecatedCallback(null);\n\n        throw error;\n      }\n    );\n  },\n\n  getImage(url, options = {}, callback) {\n    if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n\n    const deprecatedCallback = function() {\n      if (callback && typeof callback === 'function') {\n        CD.log(DEPRECATION_MSG);\n\n        return callback(...arguments);\n      }\n    };\n\n    const msg = `getImage: ${url}`;\n\n    return new Promise(function(resolve, reject) {\n      const img = new Image();\n\n      img.onload = function() {\n        CD.resume(msg);\n\n        deprecatedCallback(img);\n\n        resolve(img);\n      };\n\n      img.onerror = function(event) {\n        CD.resume(msg);\n\n        deprecatedCallback(null);\n\n        reject(event);\n      };\n\n      CD.pause(options.maxSuspension, msg);\n      img.src = url;\n    });\n  },\n\n  /**\n   * NOTE: getImages is intended to be used with promises. The `afterAll` callback is\n   * now deprecated, and the order of the afterEach and afterAll arguments has\n   * been reversed since previous versions of cropduster.\n   *\n   * To achieve the same effect, users should pass a single callback into the\n   * arguments for getImages, and then use a `.then` call to handle any actions\n   * after all images have finished loading.\n   *\n   * If any image fails to load, the Promise will reject.\n   */\n  getImages(urls, options = {}, afterEach, afterAll) {\n    const msg = 'getImages:';\n    CD.pause(options.maxSuspension, msg);\n\n    if (typeof options === 'function') {\n      afterAll = afterEach;\n      afterEach = options;\n      options = {};\n    }\n\n    const promises = urls.map(url => {\n      return this.getImage(url, options.maxSuspension).then(img => {\n        if (afterEach) {\n          afterEach(img);\n        }\n\n        return img;\n      });\n    });\n\n    return Promise.all(promises).then(\n      images => {\n        if (afterAll) {\n          CD.log(DEPRECATION_MSG);\n          afterAll(images);\n        }\n\n        CD.resume(msg);\n        return images;\n      },\n      _ => {\n        CD.resume(msg);\n        throw new Error('Not all images loaded successfully');\n      });\n  },\n\n  waitForAsset(assetUrl) {\n    CD.miCaptureFallback(\n      () => { MICapture.waitForAsset(assetUrl); },\n      () => { CD.log(`Wait for asset: ${assetUrl}`); }\n    );\n  },\n\n  log(message) {\n    console.log(message);\n  },\n\n  miCaptureFallback(ifCapturama, ifBrowser) {\n    const loadedInCapturama = !!window.MICapture && typeof window.MICapture === 'object';\n    return loadedInCapturama ? ifCapturama() : ifBrowser();\n  },\n\n  _hashForRequest(url, options) {\n    const str = `${url}${JSON.stringify(options)}`;\n\n    let hash = 0;\n    if (str.length === 0) return hash;\n\n    for (let i = 0; i < str.length; i++) {\n      hash = ((hash << 5) - hash + str.charCodeAt(i)) & 0xffffffff;\n    }\n\n    return hash.toString();\n  },\n\n  _optionsForFetch(options) {\n    const requestOptions = {\n      redirect: 'follow',\n      headers: new Headers(options.headers || {}),\n      method: options.method || 'GET',\n      body: options.body,\n      mode: 'cors'\n    };\n\n    if (!options.withoutCredentials) {\n      requestOptions.credentials = 'include';\n    }\n\n    return requestOptions;\n  }\n};\n\nexport default CD;\n","import CD from 'cropduster';\n\nexport default class DataSource {\n  key: string;\n  sorcererUrlBase: string;\n\n  constructor(key: string) {\n    this.key = key;\n    this.sorcererUrlBase =\n      'https://sorcerer.movableink-templates.com/data_sources';\n  }\n\n  /**\n   *\n   * @param params\n   * @param options\n   */\n  async getRawData(params: object, options = {}) {\n    const paramStr = Object.keys(params)\n      .map((key) => {\n        return key + '=' + params[key];\n      })\n      .join('&');\n\n    const url = `${this.sorcererUrlBase}/${this.key}?${paramStr}`;\n\n    options['cacheTime'] = options['cacheTime'] || 10 * 1000;\n    options['headers'] = options['headers'] || {};\n\n    options['headers']['x-reverse-proxy-ttl'] = options['cacheTime'] / 1000;\n    options['headers']['x-mi-cbe'] = CD._hashForRequest(url, options);\n\n    return await CD.get(url, options);\n  }\n\n  /**\n   *\n   * @param params\n   * @param opts\n   */\n  async getAllRows(params: object, opts = {}) {\n    params['mi_multiple'] = true;\n\n    if (opts['headers']) {\n      params['mi_include_headers'] = true;\n      opts['headers'] = {};\n    }\n    const { data } = await this.getRawData(params, opts);\n    return JSON.parse(data);\n  }\n\n  /**\n   *\n   * @param opts\n   */\n  async getMultipleRows(opts: any = {}) {\n    const params = {\n      mi_multiple: true,\n      mi_include_headers: true,\n    };\n\n    const { method = null } = opts;\n\n    if (!method && method.toLowerCase() !== 'post') {\n      throw new Error('Request method must be POST for getMultipleRows');\n    }\n\n    const { data } = await this.getRawData(params, opts);\n    return JSON.parse(data);\n  }\n}\n"],"names":[],"mappings":"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"}