{"version":3,"file":"out.js","sources":["node_modules/cropduster/dist/cropduster.module.js","src/index.ts"],"sourcesContent":["var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nvar DEPRECATION_MSG = 'callbacks are deprecated in cropduster, prefer using promises for asynchronous operations';\n\nvar CD = {\n  CORS_PROXY_SERVER: 'https://cors.movableink.com',\n\n  $: function $(selector, doc) {\n    if (!doc) {\n      doc = document;\n    }\n\n    return [].concat(_toConsumableArray(doc.querySelectorAll(selector)));\n  },\n  _initParams: function _initParams() {\n    CD._urlParams = {};\n    var search = /([^&=]+)=?([^&]*)/g;\n    var query = CD._searchString();\n\n    var match = search.exec(query);\n    while (match) {\n      CD._urlParams[decodeURIComponent(match[1])] = decodeURIComponent(match[2]);\n      match = search.exec(query);\n    }\n  },\n  param: function param(name) {\n    return CD.params()[name];\n  },\n  params: function params(name) {\n    var params = CD._urlParams;\n    if (typeof params === 'undefined') {\n      CD._initParams();\n      params = CD._urlParams;\n    }\n\n    if (name) {\n      return params[name];\n    } else {\n      return params;\n    }\n  },\n  _searchString: function _searchString() {\n    return window.location.search.substring(1);\n  },\n  autofill: function autofill() {\n    CD.param('init'); // inits CD._urlParams\n    var params = CD._urlParams;\n    for (var key in params) {\n      if (params[key] !== 'undefined' && params[key].length > 0) {\n        if (document.getElementById('autofill_' + key)) {\n          document.getElementById('autofill_' + key).innerHTML = params[key];\n        }\n      }\n    }\n  },\n  throwError: function throwError(msg) {\n    CD.miCaptureFallback(function () {\n      MICapture.error(msg);\n    }, function () {\n      CD.log('Capturama error: ' + msg);\n    });\n  },\n  cancelRequest: function cancelRequest(msg) {\n    CD.miCaptureFallback(function () {\n      MICapture.cancel(msg);\n    }, function () {\n      CD.log('Request canceled: ' + msg);\n    });\n  },\n  setImageRedirect: function setImageRedirect(imageUrl) {\n    var a = document.getElementById('mi-redirect-image') || document.createElement('a');\n\n    a.href = imageUrl;\n    a.id = 'mi-redirect-image';\n    a.style.display = 'none';\n\n    document.body.appendChild(a);\n\n    return a;\n  },\n  setClickthrough: function setClickthrough(url) {\n    var a = document.getElementById('mi_dynamic_link') || document.createElement('a');\n\n    a.href = url;\n    a.id = 'mi_dynamic_link';\n    a.style.display = 'none';\n\n    document.body.appendChild(a);\n\n    return a;\n  },\n  setExtraData: function setExtraData(dataObject) {\n    var el = document.getElementById('mi-data') || document.createElement('div');\n\n    el.id = 'mi-data';\n    el.style.display = 'none';\n\n    var existingData = void 0;\n    try {\n      existingData = JSON.parse(el.getAttribute('data-mi-data')) || {};\n    } catch (_) {\n      // Overwrite if there was something in mi-data that wasn't JSON\n      existingData = {};\n    }\n\n    for (var key in dataObject) {\n      if (dataObject.hasOwnProperty(key)) {\n        existingData[key] = dataObject[key];\n      }\n    }\n\n    el.setAttribute('data-mi-data', JSON.stringify(existingData));\n    document.body.appendChild(el);\n\n    return el;\n  },\n  proxyUrl: function proxyUrl(url) {\n    var a = document.createElement('a');\n    a.href = url;\n\n    var port = '';\n    if (a.port === '0' || a.port === '') {\n      port = a.protocol === 'https:' ? ':443' : '';\n    } else {\n      port = ':' + a.port;\n    }\n\n    var hostname = a.hostname,\n        pathname = a.pathname,\n        search = a.search,\n        hash = a.hash;\n\n    return CD.CORS_PROXY_SERVER + '/' + hostname + port + pathname + search + hash;\n  },\n\n\n  // internal, do not modify\n  _readyToCapture: true,\n\n  _reset: function _reset() {\n    CD._readyToCapture = true;\n  },\n  pause: function pause(maxSuspension) {\n    var msg = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'manual suspension';\n\n    if (maxSuspension) {\n      msg += ', will end in ' + maxSuspension + 'ms';\n\n      setTimeout(function () {\n        CD.resume(msg);\n      }, maxSuspension);\n    }\n\n    CD.miCaptureFallback(function () {\n      MICapture.pause(msg);\n    }, function () {\n      CD.log('paused: ' + msg);\n    });\n  },\n  resume: function resume(msg) {\n    CD.miCaptureFallback(function () {\n      MICapture.resume(msg);\n    }, function () {\n      CD.log('resuming paused capture: ' + msg);\n    });\n  },\n  getCORS: function getCORS(url) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var callback = arguments[2];\n\n    if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n\n    options.corsCacheTime = options.corsCacheTime || 10 * 1000;\n    if (!/cors.movableink.com/.test(url) && !/profiles.movableink.com/.test(url) && !/sorcerer.movableink-templates.com/.test(url)) {\n      url = CD.proxyUrl(url);\n    }\n\n    options.headers = options.headers || {};\n    options.headers['x-reverse-proxy-ttl'] = options.corsCacheTime / 1000;\n    options.headers['x-mi-cbe'] = this._hashForRequest(url, options);\n\n    return CD.get(url, options, callback);\n  },\n  get: function get(url) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var callback = arguments[2];\n\n    if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n\n    var msg = 'xhr: ' + url;\n    var deprecatedCallback = function deprecatedCallback() {\n      if (callback && typeof callback === 'function') {\n        CD.log(DEPRECATION_MSG);\n        return callback.apply(undefined, arguments);\n      }\n    };\n\n    CD.pause(options.maxSuspension || 0, msg);\n\n    return ajaxPromise(url, options).then(function (response) {\n      var contentType = response.getResponseHeader('content-type');\n      var status = response.status,\n          data = response.responseText;\n\n\n      deprecatedCallback(data, status, contentType);\n\n      return {\n        data: data,\n        status: status,\n        contentType: contentType,\n        response: response\n      };\n    }).then(function (response) {\n      CD.resume(msg);\n      return response;\n    }, function (error) {\n      CD.log('Error encountered in CD.get for ' + url + ': ' + error);\n      CD.resume(msg);\n\n      deprecatedCallback(null);\n\n      throw error;\n    });\n  },\n  getImage: function getImage(url) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var callback = arguments[2];\n\n    if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n\n    var deprecatedCallback = function deprecatedCallback() {\n      if (callback && typeof callback === 'function') {\n        CD.log(DEPRECATION_MSG);\n\n        return callback.apply(undefined, arguments);\n      }\n    };\n\n    var msg = 'getImage: ' + url;\n\n    return new Promise(function (resolve, reject) {\n      var img = new Image();\n\n      img.onload = function () {\n        CD.resume(msg);\n\n        deprecatedCallback(img);\n\n        resolve(img);\n      };\n\n      img.onerror = function (event) {\n        CD.resume(msg);\n\n        deprecatedCallback(null);\n\n        reject(event);\n      };\n\n      CD.pause(options.maxSuspension, msg);\n      img.src = url;\n    });\n  },\n\n\n  /**\n   * NOTE: getImages is intended to be used with promises. The `afterAll` callback is\n   * now deprecated, and the order of the afterEach and afterAll arguments has\n   * been reversed since previous versions of cropduster.\n   *\n   * To achieve the same effect, users should pass a single callback into the\n   * arguments for getImages, and then use a `.then` call to handle any actions\n   * after all images have finished loading.\n   *\n   * If any image fails to load, the Promise will reject.\n   */\n  getImages: function getImages(urls) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    var _this = this;\n\n    var afterEach = arguments[2];\n    var afterAll = arguments[3];\n\n    var msg = 'getImages:';\n    CD.pause(options.maxSuspension, msg);\n\n    if (typeof options === 'function') {\n      afterAll = afterEach;\n      afterEach = options;\n      options = {};\n    }\n\n    var promises = urls.map(function (url) {\n      return _this.getImage(url, options.maxSuspension).then(function (img) {\n        if (afterEach) {\n          afterEach(img);\n        }\n\n        return img;\n      });\n    });\n\n    return Promise.all(promises).then(function (images) {\n      if (afterAll) {\n        CD.log(DEPRECATION_MSG);\n        afterAll(images);\n      }\n\n      CD.resume(msg);\n      return images;\n    }, function (_) {\n      CD.resume(msg);\n      throw new Error('Not all images loaded successfully');\n    });\n  },\n  waitForAsset: function waitForAsset(assetUrl) {\n    CD.miCaptureFallback(function () {\n      MICapture.waitForAsset(assetUrl);\n    }, function () {\n      CD.log('Wait for asset: ' + assetUrl);\n    });\n  },\n  log: function log(message) {\n    console.log(message);\n  },\n  miCaptureFallback: function miCaptureFallback(ifCapturama, ifBrowser) {\n    var loadedInCapturama = !!window.MICapture && _typeof(window.MICapture) === 'object';\n    return loadedInCapturama ? ifCapturama() : ifBrowser();\n  },\n  _hashForRequest: function _hashForRequest(url, options) {\n    var str = '' + url + JSON.stringify(options);\n\n    var hash = 0;\n    if (str.length === 0) return hash;\n\n    for (var i = 0; i < str.length; i++) {\n      hash = (hash << 5) - hash + str.charCodeAt(i) & 0xffffffff;\n    }\n\n    return hash.toString();\n  }\n};\n\nfunction ajaxPromise(url, options) {\n  return new Promise(function (resolve, reject) {\n    var req = new XMLHttpRequest();\n\n    req.onerror = function () {\n      reject(this.status);\n    };\n\n    req.onload = function () {\n      resolve(this);\n    };\n\n    req.open(options.method || 'GET', url, true);\n\n    if (!options.withoutCredentials) {\n      req.withCredentials = true;\n    }\n\n    if (options.headers) {\n      var headers = options.headers;\n\n      Object.keys(headers).forEach(function (header) {\n        req.setRequestHeader(header, headers[header]);\n      });\n    }\n\n    req.send(options.body);\n  });\n}\n\nexport default CD;\n","import CD from 'cropduster';\n\nexport default class DataSource {\n  key: string;\n  sorcererUrlBase: string;\n  miParams: Object;\n\n  constructor(key: string) {\n    this.key = key;\n    this.sorcererUrlBase =\n      'https://sorcerer.movableink-templates.com/data_sources';\n    this.miParams = {\n      latitude: 'mi_lat',\n      longitude: 'mi_lon',\n      includeHeaders: 'mi_include_headers',\n      multiple: 'mi_multiple',\n      radius: 'mi_radius'\n    };\n  }\n\n  /**\n   *\n   * @param params\n   * @param options\n   */\n  async getRawData(params: object, options = {}) {\n    const paramStr = Object.keys(params)\n      .map((key) => {\n        return key + '=' + params[key];\n      })\n      .join('&');\n\n    const url = `${this.sorcererUrlBase}/${this.key}?${paramStr}`;\n\n    options['cacheTime'] = options['cacheTime'] || 10 * 1000;\n    options['headers'] = options['headers'] || {};\n\n    options['headers']['x-reverse-proxy-ttl'] = options['cacheTime'] / 1000;\n    options['headers']['x-mi-cbe'] = CD._hashForRequest(url, options);\n\n    return await CD.get(url, options);\n  }\n\n  /**\n   *\n   * @param params\n   * @param opts\n   */\n  async getAllRows(params: object, opts = {}) {\n    params['mi_multiple'] = true;\n\n    if (opts['headers']) {\n      params['mi_include_headers'] = true;\n      opts['headers'] = {};\n    }\n    const { data } = await this.getRawData(params, opts);\n    return JSON.parse(data);\n  }\n\n  /**\n   *\n   * @param opts\n   */\n  async getMultipleTargets(sets: any = [], opts: any = {}) {\n    const params = {\n      mi_multiple: true,\n      mi_include_headers: true,\n    };\n\n    const options = {\n      method: 'POST',\n      body: JSON.stringify(sets)\n    }\n\n    Object.assign(options, opts);\n\n    const { method = null } = options;\n    if (!method && method.toLowerCase() !== 'post') {\n      throw new Error('Request method must be POST for getMultipleTargets');\n    }\n\n    const { data } = await this.getRawData(params, options);\n    return JSON.parse(data);\n  }\n\n  /**\n   *\n   * @param set\n   * @param opts\n   */\n  async getSingleTarget(set: any = {}, opts: any = {}) {\n    return await this.getMultipleTargets([set], opts);\n  }\n\n  /**\n   *\n   * @param params\n   * @param opts\n   */\n  async getLocationTargets(params: any = {}, opts: any = {}) {\n    const queryParams = {\n      mi_multiple: true,\n      mi_include_headers: true,\n    };\n\n    for (const key in params) {\n      const paramName = this.miParams[key];\n      if (paramName) {\n        queryParams[paramName] = params[key];\n      } else {\n        queryParams[key] = params[key];\n      }\n    }\n\n    const { data } = await this.getRawData(queryParams, opts);\n    return JSON.parse(data);\n  }\n\n}\n"],"names":[],"mappings":"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"}